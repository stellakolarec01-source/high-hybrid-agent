import random
import pygame
import pyttsx3
import time

# Initialize pyttsx3 engine for TTS (Text-to-Speech)
engine = pyttsx3.init()

# Initialize pygame mixer for sound effects
pygame.mixer.init()

# Dictionary to represent different emotions and responses
emotions = {
    "happy": ["Yay! Youâ€™re on top of the world today, huh?", "I bet you're smiling all the way to the moon!", "Feeling awesome, huh? Keep that energy up!", "Whoâ€™s got a happy vibe today? You! ðŸ˜Ž"],
    "sad": ["Aww, what's wrong? It's okay, we all have bad days. Want me to tell you a joke?", "Youâ€™re feeling a bit down? Don't worry, I'll help you feel better.", "Hey, life can be a bit much sometimes... but hey, how about a hug from me?", "You're sad? Let's turn that frown upside down, okay?"],
    "angry": ["Whoa, someone's having a bad day... Calm down, buddy!", "Is someone grumpy today? Let it all out, Iâ€™m here!", "Donâ€™t let the anger win! Deep breaths... come on!", "Feeling feisty? Let's channel that energy into something fun."],
    "surprised": ["Whoa, plot twist! Didnâ€™t see that coming!", "You look *shocked*â€”tell me more!", "You did NOT just say that! Iâ€™m blown away! ðŸ˜±", "Are you pulling my leg or is this for real?"],
    "fear": ["Uh-oh, feeling scared? It's okay, we all get nervous. You got this!", "Is something scaring you? It's alright, take a deep breath!", "Fear is just excitement in disguise, donâ€™t worry!", "I sense some tensionâ€”let's turn that fear into fun, shall we?"],
    "confused": ["Wait, what? That was a plot twist I didn't expect!", "Lost? It's okay, Iâ€™m here to help you figure it out!", "Are you pulling my brain into a maze? ðŸ˜‚ Let me help you out!", "Youâ€™re confused? Donâ€™t worry, Iâ€™m even more lost than you are sometimes."]
}

# Sounds mapped to emotions (make sure you have actual sound files in your project)
sound_effects = {
    "happy": "sounds/happy_sound.mp3",
    "sad": "sounds/sad_sound.mp3",
    "angry": "sounds/angry_sound.mp3",
    "surprised": "sounds/surprised_sound.mp3",
    "fear": "sounds/fear_sound.mp3",
    "confused": "sounds/confused_sound.mp3",
}

# Function to detect emotions in the user input
def detect_emotion(message):
    if "happy" in message.lower():
        return "happy"
    elif "sad" in message.lower():
        return "sad"
    elif "angry" in message.lower():
        return "angry"
    elif "surprised" in message.lower():
        return "surprised"
    elif "fear" in message.lower():
        return "fear"
    elif "confused" in message.lower():
        return "confused"
    else:
        return None

# Generate a random emotional response based on the detected emotion
def get_emotion_response(emotion):
    if emotion and emotion in emotions:
        return random.choice(emotions[emotion])
    return "I have no clue how you're feeling right now, but I'm here for you!"

# Function to speak the response out loud
def speak(response):
    engine.say(response)  # Pass the text response to the engine
    engine.runAndWait()  # Process the speech and wait for it to finish

# Function to simulate thinking delay (reaction time)
def thinking_delay():
    print("ðŸ¤– EmotioBot is thinking...")
    time.sleep(2)  # Delay of 2 seconds to simulate reaction time

# Function to play the sound effect based on emotion
def play_sound(emotion):
    if emotion in sound_effects:
        pygame.mixer.music.load(sound_effects[emotion])
        pygame.mixer.music.play()
        while pygame.mixer.music.get_busy():  # Wait for the sound to finish playing
            pygame.time.Clock().tick(10)

# Main function
def main():
    print("ðŸ¤– EmotioBot: Hey there! Tell me how you're feeling. (Type 'exit' to quit)")
    
    while True:
        user_input = input("You: ")

        if user_input.lower() == "exit":
            print("ðŸ¤– EmotioBot: Bye! Take care of your emotions. :)")
            speak("Goodbye!")
            break
        
        # Simulate a thinking delay before responding
        thinking_delay()

        # Detect emotion and respond accordingly
        detected_emotion = detect_emotion(user_input)
        response = get_emotion_response(detected_emotion)
        
        print("ðŸ¤– EmotioBot:", response)
        speak(response)  # Speak the response out loud
        play_sound(detected_emotion)  # Play the corresponding sound effect

if __name__ == "__main__":
    main()
